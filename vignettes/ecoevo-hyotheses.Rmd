---
title: "ecoevo-hypotheses"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{ecoevo-hyotheses}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(ecoevor)
library(deSolve)
library(tidyverse)
```
## 1 Overview
Eco-evolutionary hypothesis testing is implemented by using theoretical or simulation models to compare alternative mechanistic processes that may be structuring data. We introduce two eco-evolutionary models and for each, we run simulations under parameter values or model components that match distinct eco-evolutionary hyotheses. In a separate vignette eco-evo-ABC, we describe how to use Approximate Bayesian Computing (and alternatively machine learning) to compare data generated under these alternative hypotheses to observed data (albeit such data is simulated in these examples).

## 2 Example 1. pathogen-virulence model
In Figure 2 of Pantel & Becks 202x, we discuss a host-pathogen model of eco-evolutionary dynamics described in Luo & Koelle (2013). The model equations are given as:

$$ \frac{dS}{dt} ={B - \beta(\alpha)SI - \mu S} $$
$$ \frac{dI}{dt} ={\beta(\alpha)SI - (\mu + \alpha) I} $$
$$ \frac{d\alpha}{dt} = V(S \frac{d\beta}{d\alpha}-1) = V(S \frac{c}{\gamma}\alpha^{(\frac{1}{\gamma})-1}-1) $$

where *S* and *I* are the susceptible and infected host population size, *B* is a constant birth rate, μ is the per capita death rate, α is the disease-induced mortality rate (virulence), and β is the transmission rate. The transmission-virulence trade-off is modeled by $\beta(\alpha) = c\alpha^{\frac{1}{\gamma}}$, where *c* is a positive constant, γ indicates the magnitude of the transmission-virulence tradeoff, and *V* is the additive genetic variance.

Virulence (α) can evolve if the additive genetic variance for this trait *V* > 0, and the rate of change for this trait depends on the susceptible host population size (*d*α/*dt* ~ *f*(*S*)). This link between the evolving trait and host population dynamics can represent an eco-evolutionary feedback as *S* ~ *f*(α) and *d*α/*dt* ~ *f*(*S*) (Lion 2018).

```{r}
x <- "alfa,bravo,charlie,delta"
strsplit1(x, split = ",")
```


### 2.1 Hypothesis 1
One potential null hypothesis for this system could be that phenotypic evolution is not possible (the additive genetic variance for virulence *V* = 0).

STOPPED

```{r}
# H1. No evolution (V = 0)
parms <- c(B = (10^7), mu = 1, V = 0, gam = 2, c = 3*10^-7)
times <- seq(from=0,to=40,by=1)
xstart <- c(S=10^7,I=1,alpha=4)
out <- hostpath_evol(times,xstart,parms)
```









, with an alternative hypothesis where evolution (V > 0) and a feedback between evolution and ecology is possible, and an additional alternative hypothesis where eco-evolutionary dynamics are removed from the system by decoupling the dependence of virulence evolution from host population dynamics (dα/dt !~ f(S); Figure 1). Additional simulations can be used to explore the impacts of different trade-off functions (between virulence and transmission, or in the relationship between evolutionary change in virulence and population size of susceptible hosts.

Eco-evolutionary hypotheses for structure of observed dynamics. (a-b) Simulations of the eco-evolutionary epidemiological model with virulence evolution (Luo & Koelle 2013) are shown with many of the same model parameters (e.g. S0 = X, α0 = 4, γ = 2; see Supplement X for additional parameter values), but under three alternative hypotheses that can be used to compare to observed data to identify the existence of trait evolution and of eco-evolutionary feedbacks. In (a), the model is simulated under Hypothesis 1 (H1) of an ecological-only model, where population size of the host (S = susceptible individuals, I = infected individuals; solid lines) varies over time as a function of fixed traits (B = birth rate, β = transmission rate, γ = magnitude of transmission-virulence tradeoff, α = virulence). The model is also simulated under Hypothesis 2 (H2) of an eco-evolutionary dynamics model, where α can evolve as a function of a transmission-virulence tradeoff (β(α) = cα1/γ; dashed lines) if there is phenotypic variance V (set to 4 here). The virulence evolution is density-dependent, and includes an eco-evolutionary feedback loop: ecology (the host population density) affects evolution of virulence (selection for increased or reduced virulence; dα/dt ~ f(S)), evolution of virulence affects ecology via the number of susceptible hosts (dS/dt ~ f(I), dI/dt ~ f(α)), and this change in host population size in turn affects the selection for virulence. In (b), the model is simulated under Hypothesis 3 (H3) with interactions between evolution and ecology, but no eco-evolutionary feedback loop - virulence evolution is independent of the susceptible host population size (S), but instead depends on the same transmission-virulence tradeoff β(α) = cα1/γ; and a constant value (5×106).


lain text and equations to describe model. Describe overall approach.

### 2.1 Hypothesis 1. XXX
Plain text and output to describe hyothesis 1.

## References
Lion, S. (2018). Theoretical approaches in evolutionary ecology: environmental feedback as a unifying perspective. The American Naturalist, 191(1), 21-44.

Luo, S., & Koelle, K. (2013). Navigating the devious course of evolution: the importance of mechanistic models for identifying eco-evolutionary dynamics in nature. The American Naturalist, 181(S1), S58-S75.
